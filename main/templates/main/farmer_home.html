{% extends 'main/base.html' %} 
{% load static %}
{% block title %}Registered Farms{% endblock %} 
{% block content %}
<div class="container mt-5">
  <div class="row justify-content-center">
     {% if user.has_farm %}
      <div class="col-md-4 mb-4">
        {% if messages %}
        <div class="alert alert-success" role="alert">
          <ul class="messages">
              {% for message in messages %}
                  <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>
                      {{ message }}
                      {% if message.tags == 'success' %}
                          <i class="fas fa-check fa-lg ml-2"></i>
                      {% endif %}
                  </li>
              {% endfor %}
          </ul>
      </div>
    {% endif %}
      <div class="card h-100 d-flex flex-column">
        <img src="{% static 'images/cassava_farm.jpeg' %}" class="card-img-top" alt="Cassava Harvest Image">
        <div class="card-header">
          <strong>Your Registered Farms</strong>
        </div>
        <div class="card-body d-flex flex-column">
         <p class="card-text">Implementing effective cassava farm management involves optimizing soil health, implementing pest control measures, and employing efficient harvesting techniques.</p>
         <hr class="mt-2">
         <a href="{% url 'add_farm' %}" class="btn btn-success mt-2 mb-3"><i class="fas fa-plus me-3"></i>Register</a>
         <ul>
         {% for farm in latest_user_farms %}
          <div class="d-flex justify-content-between align-items-center mb-2">
              <a href="{% url 'farm_details' farm.id %}" style="text-decoration: none; display: flex; align-items: center;" class="text-success">
                  <span class="material-icons card-text mb-0 me-2">photo_camera_back</span>
                  <span class="card-text mb-0"><b>{{ farm.name }}</b></span>
              </a>
            </div>
           {% endfor %}
           </ul>
           
           {% if farms|length > 3 %}
              <a href="" class="text-success mt-2">View More</a>
           {% endif %}
        </div>
      </div>
    </div>

    {% else %}
      <div class="col-md-4 mb-4">
      <div class="card">
        <img src="{% static 'images/cassava.jpeg' %}" class="card-img-top" alt="Cassava Image">
        <div class="card-header">
          Farmer bio-data & Geo-tagging
        </div>
        <div class="card-body">
          <p class="card-text">Cassava, maize, and rice are crucial staple crops globally. Cassava is a versatile root crop, while maize and rice, as cereal grains, play vital roles in providing sustenance and ensuring food security for millions worldwide.</p>
          <a href="{% url 'add_farm' %}" class="btn btn-primary">Add a Farm</a>
        </div>
      </div>
    </div>
    {% endif %}

    {% if is_field_agent %}
        <div class="col-md-4 mb-4">
          <div class="card">
            <img src="{% static 'images/cassava.jpeg' %}" class="card-img-top" alt="Cassava Image">
            <div class="card-header">
              <p class="fw-bold">Welcome, Field Agent! </p>
              <hr>
              {% if not user.district %}
                <p class="fw-bold">To map you to farms, Update your Profile!</p>
              {% endif %}
              {% if user.district %}
                <p class="fw-bold"><p>Farms Registered in your District: <b class="text-success">{{user.district}}</b></p></p>
              {% endif %}
            </div>
            <div class="card-body">
                 {% if user.district %}
                <ul>
                  {% for farm in farms_in_agent_district %}
                     <div class="d-flex justify-content-between align-items-center mb-2">
                        <a href="{% url 'farm_details' farm.id %}" style="text-decoration: none; display: flex; align-items: center;" class="text-success">
                            <span class="material-icons card-text mb-0 me-2">photo_camera_back</span>
                            <span class="card-text mb-0"><b>{{ farm.name }}</b></span>
                        </a>
                      </div>
                  {% endfor %}
                </ul>
              {% endif %}
              {% if farms_in_agent_district|length > 3 %}
              <a href="" class="text-success mt-2">View More</a>
               {% endif %}              
            </div>
          </div>
        </div>
      {% endif %}

  </div>
</div>
{% block javascript %}
    <script src="{% static 'js/custom.js' %}"></script>
{% endblock %}
{% endblock %}
